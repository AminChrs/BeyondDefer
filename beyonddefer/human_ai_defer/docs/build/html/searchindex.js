Search.setIndex({"docnames": ["baselines", "datasetsdefer", "helpers", "index", "modules", "networks"], "filenames": ["baselines.rst", "datasetsdefer.rst", "helpers.rst", "index.rst", "modules.rst", "networks.rst"], "titles": ["baselines package", "datasetsdefer package", "helpers package", "Welcome to Human Deferral\u2019s documentation!", "improved_deferral", "networks package"], "terms": {"class": [0, 1, 2, 5], "arg": [0, 1], "kwarg": [0, 1, 5], "sourc": [0, 1, 2, 5], "base": [0, 1, 2, 5], "abc": [0, 1], "abstract": [0, 1], "method": [0, 1, 2], "learn": [0, 1], "defer": [0, 1, 2], "fit": [0, 2], "thi": [0, 1, 5], "function": [0, 5], "should": [0, 1, 5], "model": [0, 2, 5], "enough": 0, "evalu": 0, "fit_hyperparam": 0, "an": 0, "option": [0, 2], "optim": 0, "hyperparamet": 0, "over": 0, "valid": [0, 1], "set": [0, 1], "test": [0, 1], "dataload": 0, "return": [0, 2, 5], "dict": [0, 2], "follow": [0, 1], "kei": 0, "binari": [0, 5], "predict": [0, 1, 2], "pred": [0, 2], "classifi": [0, 2, 5], "label": [0, 1, 2], "hum_pr": [0, 2], "human": [0, 1, 2], "rej_scor": [0, 2], "real": 0, "score": 0, "rejector": 0, "higher": 0, "more": 0, "like": 0, "reject": 0, "class_prob": [0, 2], "probabl": 0, "each": 0, "can": [0, 1], "well": 0, "basesurrogatemethod": 0, "alpha": [0, 1], "plotting_interv": 0, "devic": [0, 1, 5], "surrog": 0, "dataloader_train": [0, 2], "dataloader_v": 0, "dataloader_test": [0, 2], "epoch": [0, 2], "lr": [0, 2], "schedul": 0, "none": [0, 1], "verbos": [0, 2], "true": [0, 2, 5], "test_interv": [0, 2], "5": [0, 1, 2], "fit_epoch": 0, "fals": [0, 1, 2, 5], "1": [0, 1, 2, 5], "one": [0, 5], "train": [0, 1, 4, 5], "print": 0, "loss": 0, "number": [0, 1, 2], "surrogate_loss_funct": 0, "output": [0, 2], "data_i": 0, "compareconfid": 0, "model_class": 0, "model_expert": 0, "100": [0, 1], "indeped": 0, "cross": 0, "entropi": 0, "expert": [0, 1, 2], "whether": 0, "equal": 0, "ground": 0, "truth": 0, "Then": 0, "point": [0, 1], "we": 0, "compar": 0, "confid": 0, "paramet": [0, 2], "_type_": [0, 2], "val": [0, 2], "_description_": 0, "rate": 0, "default": [0, 2], "bool": [0, 5], "int": [0, 2], "metric": [0, 4], "type": [0, 2, 5], "fit_epoch_class": 0, "singl": 0, "param": [0, 2, 5], "fit_epoch_expert": 0, "differentiabletriag": 0, "model_rejector": 0, "weight_low": 0, "0": [0, 1, 5], "strategi": 0, "human_error": 0, "find_machine_sampl": 0, "model_output": 0, "arrai": 0, "size": 0, "input": 0, "indic": 0, "poin": 0, "fit_epoch_class_triag": 0, "fit_epoch_rejector": 0, "weighted_cross_entropy_loss": 0, "weight": 0, "weigth": 0, "network": [0, 3, 4], "softmax": [0, 5], "target": [0, 1, 2], "exampl": 0, "scalar": 0, "lcesurrog": 0, "implment": 0, "l_": 0, "ce": 0, "lpha": 0, "mixtureofexpert": 0, "implement": 0, "madra": 0, "et": [0, 1], "al": [0, 1], "2018": 0, "mixtures_of_experts_loss": 0, "human_is_correct": 0, "mixtur": 0, "from": [0, 1, 5], "ovasurrog": 0, "ova": 0, "calibr": 0, "One": 0, "vs": 0, "all": [0, 2, 5], "http": [0, 1], "proceed": 0, "mlr": 0, "press": 0, "v162": 0, "verma22c": 0, "pdf": 0, "logisticlossova": 0, "y": 0, "ova_loss": 0, "m": 0, "cost": 0, "selectivepredict": 0, "select": 0, "data": [0, 1, 2], "threshold": 0, "max": 0, "prob": 0, "set_optimal_threshold": 0, "maxim": 0, "system": 0, "accuraci": [0, 2], "generate_data": 1, "gener": [1, 2], "loader": 1, "call": [1, 5], "init": 1, "must": 1, "self": 1, "data_train_load": 1, "data_val_load": 1, "data_test_load": 1, "d": 1, "dimens": 1, "n_dataset": 1, "browarddataset": 1, "data_dir": 1, "test_split": 1, "2": 1, "val_split": 1, "batch_siz": 1, "1000": 1, "transform": 1, "compa": 1, "dataset": [1, 2], "judgement": 1, "chestxraydataset": 1, "non_deferral_dataset": 1, "use_data_aug": 1, "label_chosen": 1, "chest": 1, "x": [1, 5], "rai": 1, "nih": 1, "multipl": 1, "radiologist": 1, "annot": 1, "per": 1, "googl": 1, "research": 1, "cifar10h": 1, "cifar": 1, "10h": 1, "seper": 1, "10": [1, 5], "airplan": 1, "automobil": 1, "bird": 1, "cat": 1, "3": 1, "deer": 1, "4": 1, "dog": 1, "frog": 1, "6": 1, "hors": 1, "7": 1, "ship": 1, "8": 1, "truck": 1, "9": 1, "metrics_cifar10h": 1, "exp_pr": [1, 2], "cifarsynthdataset": 1, "expert_k": 1, "cifark": 1, "synthet": 1, "top": 1, "consist": 1, "estim": 1, "arxiv": 1, "org": 1, "ab": 1, "2006": 1, "01862": 1, "cifarsynthexpert": 1, "k": 1, "n_class": 1, "object": [1, 2], "simpl": 1, "describ": 1, "our": 1, "genericdatasetdeferr": 1, "data_train": 1, "data_test": [1, 2], "genericimageexpertdataset": 1, "imag": [1, 2], "expert_pr": 1, "transforms_fn": 1, "to_open": 1, "embed_text": 1, "include_demograph": 1, "expert_typ": 1, "synth_exp_param": 1, "davidson": 1, "2017": 1, "model_set": 1, "model_nn": 1, "modelpredictaa": 1, "modelfil": 1, "vocabfil": 1, "infer_cvb0": 1, "invocab_token": 1, "numpass": 1, "load_model": 1, "predict_lang": 1, "token": 1, "thresh1": 1, "thresh2": 1, "imagenet16h": 1, "noise_vers": 1, "syntheticdata": 1, "train_sampl": 1, "test_sampl": 1, "data_distribut": 1, "mix_of_guassian": 1, "mean_scal": 1, "expert_deferred_error": 1, "expert_nondeferred_error": 1, "machine_nondeferred_error": 1, "num_of_guassian": 1, "introduc": 1, "work": 1, "compute_classification_metr": 2, "comput": [2, 5], "just": 2, "classif": 2, "field": 2, "classifier_all_acc": 2, "also": 2, "auc": 2, "preds_proba": 2, "compute_coverage_v_acc_curv": 2, "defers_al": 2, "truths_al": 2, "hum_preds_al": 2, "predictions_al": 2, "rej_score_al": 2, "class_probs_al": 2, "compute_deferral_metr": 2, "data_test_modifi": 2, "differ": 2, "coverag": 2, "level": 2, "first": 2, "element": 2, "list": 2, "_summary_": 2, "human_all_acc": 2, "how": 2, "often": 2, "train_deferral_single_model": 2, "include_schedul": 2, "train_single_model": 2, "averagemet": 2, "store": 2, "averag": 2, "current": 2, "valu": 2, "reset": 2, "updat": 2, "n": 2, "meter": 2, "new": 2, "sampl": 2, "expertdatasettensor": 2, "topk": 2, "tensor": 2, "tupl": 2, "float": 2, "improved_deferr": 3, "baselin": [3, 4], "packag": [3, 4], "datasetsdef": [3, 4], "helper": [3, 4], "index": 3, "modul": [3, 4], "search": 3, "page": 3, "submodul": 4, "basemethod": 4, "compare_confid": 4, "differentiable_triag": 4, "lce_surrog": 4, "mix_of_exp": 4, "one_v_al": 4, "selective_predict": 4, "content": 4, "basedataset": 4, "broward": 4, "chestxrai": 4, "cifar_h": 4, "cifar_synth": 4, "generic_dataset": 4, "hatespeech": 4, "imagenet_16h": 4, "synthetic_data": 4, "util": 4, "cnn": 4, "linear_net": 4, "non_linear_net": 4, "mobilenetv2": 5, "num_class": 5, "width_mult": 5, "forward": 5, "defin": 5, "perform": 5, "everi": 5, "overridden": 5, "subclass": 5, "although": 5, "recip": 5, "pass": 5, "need": 5, "within": 5, "instanc": 5, "afterward": 5, "instead": 5, "sinc": 5, "former": 5, "take": 5, "care": 5, "run": 5, "regist": 5, "hook": 5, "while": 5, "latter": 5, "silent": 5, "ignor": 5, "them": 5, "mobilenet_v2": 5, "pretrain": 5, "progress": 5, "cpu": 5, "construct": 5, "architectur": 5, "invert": 5, "residu": 5, "linear": 5, "bottleneck": 5, "If": 5, "pre": 5, "imagenet": 5, "displai": 5, "bar": 5, "download": 5, "stderr": 5, "linearnet": 5, "input_dim": 5, "out_dim": 5, "out": 5, "unit": 5, "linearnetdef": 5, "linear_net_sig": 5, "nonlinearnet": 5, "nonlinear": 5}, "objects": {"": [[0, 0, 0, "-", "baselines"], [1, 0, 0, "-", "datasetsdefer"], [2, 0, 0, "-", "helpers"], [5, 0, 0, "-", "networks"]], "baselines": [[0, 0, 0, "-", "basemethod"], [0, 0, 0, "-", "compare_confidence"], [0, 0, 0, "-", "differentiable_triage"], [0, 0, 0, "-", "lce_surrogate"], [0, 0, 0, "-", "mix_of_exps"], [0, 0, 0, "-", "one_v_all"], [0, 0, 0, "-", "selective_prediction"]], "baselines.basemethod": [[0, 1, 1, "", "BaseMethod"], [0, 1, 1, "", "BaseSurrogateMethod"]], "baselines.basemethod.BaseMethod": [[0, 2, 1, "", "fit"], [0, 2, 1, "", "fit_hyperparam"], [0, 2, 1, "", "test"]], "baselines.basemethod.BaseSurrogateMethod": [[0, 2, 1, "", "fit"], [0, 2, 1, "", "fit_epoch"], [0, 2, 1, "", "surrogate_loss_function"], [0, 2, 1, "", "test"]], "baselines.compare_confidence": [[0, 1, 1, "", "CompareConfidence"]], "baselines.compare_confidence.CompareConfidence": [[0, 2, 1, "", "fit"], [0, 2, 1, "", "fit_epoch_class"], [0, 2, 1, "", "fit_epoch_expert"], [0, 2, 1, "", "test"]], "baselines.differentiable_triage": [[0, 1, 1, "", "DifferentiableTriage"], [0, 3, 1, "", "weighted_cross_entropy_loss"]], "baselines.differentiable_triage.DifferentiableTriage": [[0, 2, 1, "", "find_machine_samples"], [0, 2, 1, "", "fit"], [0, 2, 1, "", "fit_epoch_class"], [0, 2, 1, "", "fit_epoch_class_triage"], [0, 2, 1, "", "fit_epoch_rejector"], [0, 2, 1, "", "fit_hyperparam"], [0, 2, 1, "", "test"]], "baselines.lce_surrogate": [[0, 1, 1, "", "LceSurrogate"]], "baselines.lce_surrogate.LceSurrogate": [[0, 2, 1, "", "fit_hyperparam"], [0, 2, 1, "", "surrogate_loss_function"]], "baselines.mix_of_exps": [[0, 1, 1, "", "MixtureOfExperts"]], "baselines.mix_of_exps.MixtureOfExperts": [[0, 2, 1, "", "fit"], [0, 2, 1, "", "fit_epoch"], [0, 2, 1, "", "mixtures_of_experts_loss"], [0, 2, 1, "", "test"]], "baselines.one_v_all": [[0, 1, 1, "", "OVASurrogate"]], "baselines.one_v_all.OVASurrogate": [[0, 2, 1, "", "LogisticLossOVA"], [0, 2, 1, "", "fit"], [0, 2, 1, "", "fit_epoch"], [0, 2, 1, "", "ova_loss"], [0, 2, 1, "", "test"]], "baselines.selective_prediction": [[0, 1, 1, "", "SelectivePrediction"]], "baselines.selective_prediction.SelectivePrediction": [[0, 2, 1, "", "fit"], [0, 2, 1, "", "fit_epoch_class"], [0, 2, 1, "", "set_optimal_threshold"], [0, 2, 1, "", "test"]], "datasetsdefer": [[1, 0, 0, "-", "basedataset"], [1, 0, 0, "-", "broward"], [1, 0, 0, "-", "chestxray"], [1, 0, 0, "-", "cifar_h"], [1, 0, 0, "-", "cifar_synth"], [1, 0, 0, "-", "generic_dataset"], [1, 0, 0, "-", "hatespeech"], [1, 0, 0, "-", "imagenet_16h"], [1, 0, 0, "-", "synthetic_data"]], "datasetsdefer.basedataset": [[1, 1, 1, "", "BaseDataset"]], "datasetsdefer.basedataset.BaseDataset": [[1, 2, 1, "", "generate_data"]], "datasetsdefer.broward": [[1, 1, 1, "", "BrowardDataset"]], "datasetsdefer.broward.BrowardDataset": [[1, 2, 1, "", "generate_data"]], "datasetsdefer.chestxray": [[1, 1, 1, "", "ChestXrayDataset"]], "datasetsdefer.chestxray.ChestXrayDataset": [[1, 2, 1, "", "generate_data"]], "datasetsdefer.cifar_h": [[1, 1, 1, "", "Cifar10h"]], "datasetsdefer.cifar_h.Cifar10h": [[1, 2, 1, "", "generate_data"], [1, 2, 1, "", "metrics_cifar10h"]], "datasetsdefer.cifar_synth": [[1, 1, 1, "", "CifarSynthDataset"], [1, 1, 1, "", "CifarSynthExpert"]], "datasetsdefer.cifar_synth.CifarSynthDataset": [[1, 2, 1, "", "generate_data"]], "datasetsdefer.cifar_synth.CifarSynthExpert": [[1, 2, 1, "", "predict"]], "datasetsdefer.generic_dataset": [[1, 1, 1, "", "GenericDatasetDeferral"], [1, 1, 1, "", "GenericImageExpertDataset"]], "datasetsdefer.generic_dataset.GenericDatasetDeferral": [[1, 2, 1, "", "generate_data"]], "datasetsdefer.hatespeech": [[1, 1, 1, "", "HateSpeech"], [1, 1, 1, "", "ModelPredictAAE"]], "datasetsdefer.hatespeech.HateSpeech": [[1, 2, 1, "", "generate_data"], [1, 2, 1, "", "model_setting"]], "datasetsdefer.hatespeech.ModelPredictAAE": [[1, 2, 1, "", "infer_cvb0"], [1, 2, 1, "", "load_model"], [1, 2, 1, "", "predict_lang"]], "datasetsdefer.imagenet_16h": [[1, 1, 1, "", "ImageNet16h"]], "datasetsdefer.imagenet_16h.ImageNet16h": [[1, 2, 1, "", "generate_data"]], "datasetsdefer.synthetic_data": [[1, 1, 1, "", "SyntheticData"]], "datasetsdefer.synthetic_data.SyntheticData": [[1, 2, 1, "", "generate_data"]], "helpers": [[2, 0, 0, "-", "metrics"], [2, 0, 0, "-", "training"], [2, 0, 0, "-", "utils"]], "helpers.metrics": [[2, 3, 1, "", "compute_classification_metrics"], [2, 3, 1, "", "compute_coverage_v_acc_curve"], [2, 3, 1, "", "compute_deferral_metrics"]], "helpers.training": [[2, 3, 1, "", "train_deferral_single_model"], [2, 3, 1, "", "train_single_model"]], "helpers.utils": [[2, 1, 1, "", "AverageMeter"], [2, 1, 1, "", "ExpertDatasetTensor"], [2, 3, 1, "", "accuracy"]], "helpers.utils.AverageMeter": [[2, 2, 1, "", "reset"], [2, 2, 1, "", "update"]], "networks": [[5, 0, 0, "-", "cnn"], [5, 0, 0, "-", "linear_net"], [5, 0, 0, "-", "non_linear_net"]], "networks.cnn": [[5, 1, 1, "", "MobileNetV2"], [5, 3, 1, "", "mobilenet_v2"]], "networks.cnn.MobileNetV2": [[5, 2, 1, "", "forward"], [5, 4, 1, "", "training"]], "networks.linear_net": [[5, 1, 1, "", "LinearNet"], [5, 1, 1, "", "LinearNetDefer"], [5, 1, 1, "", "Linear_net_sig"]], "networks.linear_net.LinearNet": [[5, 2, 1, "", "forward"], [5, 4, 1, "", "training"]], "networks.linear_net.LinearNetDefer": [[5, 2, 1, "", "forward"], [5, 4, 1, "", "training"]], "networks.linear_net.Linear_net_sig": [[5, 2, 1, "", "forward"], [5, 4, 1, "", "training"]], "networks.non_linear_net": [[5, 1, 1, "", "NonLinearNet"]], "networks.non_linear_net.NonLinearNet": [[5, 2, 1, "", "forward"], [5, 4, 1, "", "training"]]}, "objtypes": {"0": "py:module", "1": "py:class", "2": "py:method", "3": "py:function", "4": "py:attribute"}, "objnames": {"0": ["py", "module", "Python module"], "1": ["py", "class", "Python class"], "2": ["py", "method", "Python method"], "3": ["py", "function", "Python function"], "4": ["py", "attribute", "Python attribute"]}, "titleterms": {"baselin": 0, "packag": [0, 1, 2, 5], "submodul": [0, 1, 2, 5], "basemethod": 0, "modul": [0, 1, 2, 5], "compare_confid": 0, "differentiable_triag": 0, "lce_surrog": 0, "mix_of_exp": 0, "one_v_al": 0, "selective_predict": 0, "content": [0, 1, 2, 3, 5], "datasetsdef": 1, "basedataset": 1, "broward": 1, "chestxrai": 1, "cifar_h": 1, "cifar_synth": 1, "generic_dataset": 1, "hatespeech": 1, "imagenet_16h": 1, "synthetic_data": 1, "helper": 2, "metric": 2, "train": 2, "util": 2, "welcom": 3, "human": 3, "deferr": 3, "s": 3, "document": 3, "indic": 3, "tabl": 3, "improved_deferr": 4, "network": 5, "cnn": 5, "linear_net": 5, "non_linear_net": 5}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 6, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.viewcode": 1, "sphinx": 56}})